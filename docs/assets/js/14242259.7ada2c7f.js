"use strict";(self.webpackChunkdocusaurus_wiki=self.webpackChunkdocusaurus_wiki||[]).push([[5244],{6040:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"how_to_guides/sync_angle","title":"Synchronize Azimuth Angle","description":"Overview","source":"@site/docs/how_to_guides/sync_angle.md","sourceDirName":"how_to_guides","slug":"/how_to_guides/sync_angle","permalink":"/dev/docs/how_to_guides/sync_angle","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"howToSidebar","previous":{"title":"Synchronize Time using PTP","permalink":"/dev/docs/how_to_guides/ptp_sync_application"},"next":{"title":"Troubleshooting","permalink":"/dev/docs/how_to_guides/troubleshooting_guide"}}');var s=i(4848),a=i(8453),o=i(9030);const r={sidebar_position:5},l="Synchronize Azimuth Angle",d={},c=[{value:"Overview",id:"overview",level:2},{value:"Principle",id:"principle",level:2},{value:"Application Method",id:"application-method",level:2},{value:"Application Cases",id:"application-cases",level:2},{value:"Multi-Sensor Angle Synchronization",id:"multi-sensor-angle-synchronization",level:3},{value:"Anti-Interference between lidars",id:"anti-interference-between-lidars",level:3}];function h(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"synchronize-azimuth-angle",children:"Synchronize Azimuth Angle"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",className:"numbered-heading","data-number":"1","data-text":"Overview","data-toc-number":"1",children:"1 Overview"}),"\n",(0,s.jsx)(n.p,{children:'Hesai lidar products support the "Sync Angle" feature, which controls the lidar to rotate to a specified azimuth at the whole second moment. This feature plays a critical role in achieving real-time angle and data synchronization between the lidar and other devices (e.g. cameras, radars and lidars), ensuring high precision and stability in multi-sensor perception systems.'}),"\n",(0,s.jsx)(n.h2,{id:"principle",className:"numbered-heading","data-number":"2","data-text":"Principle","data-toc-number":"2",children:"2 Principle"}),"\n",(0,s.jsx)(n.p,{children:"Hesai lidar defines its azimuth position and applies closed-loop control on its motor speed and phase to ensure that its azimuth points to the preset direction at every whole second moment, achieving the synchronization to the reference signal."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"For mechanical rotating lidar products (with a horizontal FOV of 360\xb0, including models such as the Pandar series/QT series/XT series), the azimuth position definition can be referenced in the diagram below (XT32 - top view): 0\xb0 corresponds to the direction of lidar's cable outlet, 180\xb0 corresponds to the front direction. Within the default clockwise rotation of 360\xb0, any azimuth within the 360\xb0 range can be configured as the sync angle value."}),"\n"]}),"\n",(0,s.jsx)("img",{src:(0,o.Ay)("/img/azimuth_xt.jpg"),alt:"azimuth_xt",style:{display:"block",margin:"0 auto",width:"auto"}}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["For the model of AT128P with a horizontal FOV of less than 360\xb0 (achieving one-dimensional horizontal scanning via internal rotating mirrors), the azimuth position definition of its point cloud differs from mechanical rotating lidar products. As shown in the diagram below, the front direction of the lidar is defined as 90\xb0, the horizontal FOV boundaries are defined as 30\xb0 and 150\xb0 at both sides, corresponding to a horizontal FOV of 120\xb0. Therefore, the range of sync angle values that can be set is ",(0,s.jsx)(n.strong,{children:"30\xb0~150\xb0"}),"."]}),"\n"]}),"\n",(0,s.jsx)("img",{src:(0,o.Ay)("/img/azimuth_AT128.jpg"),alt:"azimuth_AT128",style:{display:"block",margin:"0 auto",width:"30%"}}),"\n",(0,s.jsx)(n.p,{children:"Considering the actual frame rate configuration of Hesai lidar products, the lidar operates at a cycle of either 100 ms (corresponding to a 10Hz frame rate) or 50 ms (corresponding to a 20Hz frame rate) to rotate to the configured sync angle, ensuring that each frame of data achieves angle synchronization."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"In multi-sensor systems that include lidars, the critical prerequisite for achieving angle synchronization is that these sensors must be time-synchronized using the same external clock source."})," For Hesai lidars, time synchronization can be achieved using the following two methods:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PTP time synchronization: This synchronization method defines the whole second by the whole second timestamp sent by the PTP master."}),"\n",(0,s.jsxs)(n.li,{children:["GPS time synchronization: This synchronization method defines the whole second by the rising edge of the PPS (pulse per second) signal input to the lidar (",(0,s.jsx)(n.em,{children:"only some Hesai lidar models support GPS time synchronization"}),")."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Note: If this feature is enabled without executing time synchronization, Hesai lidar will still use its internal clock PPS signal's rising edge to synchronize its azimuth output. However, due to differences in internal clocks between sensors, accurate angle synchronization between each sensors cannot be achieved."})}),"\n",(0,s.jsx)(n.h2,{id:"application-method",className:"numbered-heading","data-number":"3","data-text":"Application Method","data-toc-number":"3",children:"3 Application Method"}),"\n",(0,s.jsx)(n.p,{children:"The method to use the sync angle feature is introduced as follows:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Establish time synchronization: Synchronize the lidar with an external clock source, such as using the PTP method (specific methods are detailed in ",(0,s.jsx)(n.a,{href:"/dev/docs/how_to_guides/ptp_sync_application#application-method",children:"Synchronize Time using PTP"}),")."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Configure sync angle parameters: Configure parameters related to sync angle, including whether to enable sync angle and the exact angle value to specify the preset angle that the lidar needs to point to."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Hesai lidar supports the following methods to configure angle synchronization parameters:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Web control page (applicable to Pandar series/QT series/XT series models)"}),"\n"]}),"\n",(0,s.jsx)("img",{src:(0,o.Ay)("/img/syncangle_web.png"),alt:"syncangle_web",style:{display:"block",margin:"0 auto",width:"80%"}}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsx)(n.li,{children:"LidarUtilities software (applicable to OT128/AT128P models)"}),"\n"]}),"\n",(0,s.jsx)("img",{src:(0,o.Ay)("/img/syncangle_LU.png"),alt:"syncangle_LU",style:{display:"block",margin:"0 auto",width:"80%"}}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["Note: LidarUtilities can be downloaded from Hesai's official website (",(0,s.jsx)(n.a,{href:"https://www.hesaitech.com/downloads#ot128",children:"OT128"}),"\uff0c",(0,s.jsx)(n.a,{href:"https://www.hesaitech.com/downloads#at128",children:"AT128P"}),")."]})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:"HTTP API (using XT32 as example)"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"HTTP://<IP>/pandar.cgi?action=set&object=lidar_sync&key=sync_angle&value=<VALUE>\n"})}),"\n",(0,s.jsx)(n.p,{children:"The VALUE parameter configuration is as follows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'{\n"sync": 1,\n"syncAngle": 0\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Here, 'sync' indicates whether angle synchronization is enabled, 0 means disabled (default) and 1 means enabled; 'syncAngle' indicates the sync angle value in degrees, ranging from 0~359 (default value is 0)."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["Note: For detailed using method of HTTP API, refer to ",(0,s.jsx)(n.a,{href:"/dev/docs/how_to_guides/HTTP_api",children:"Use HTTP API"}),"."]})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"TCP API (using XT32 as example)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Send the following TCP API command to the lidar:"}),"\n",(0,s.jsxs)(n.p,{children:["Command name: Set Sync Angle; Command code: ",(0,s.jsx)(n.strong,{children:"0x18"}),";"]}),"\n",(0,s.jsx)(n.p,{children:"Command Payload: First data field 'sync_enable' indicates the sync angle status (0-disabled, 1-enabled); second data field 'sync_angle' indicates the sync angle value, ranging from 0~359 (default value is 0)."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["Note: For detailed using method of TCP API, refer to ",(0,s.jsx)(n.a,{href:"/dev/docs/how_to_guides/TCP_api",children:"Use TCP API"}),"."]})}),"\n",(0,s.jsx)(n.h2,{id:"application-cases",className:"numbered-heading","data-number":"4","data-text":"Application Cases","data-toc-number":"4",children:"4 Application Cases"}),"\n",(0,s.jsx)(n.h3,{id:"multi-sensor-angle-synchronization",className:"numbered-heading","data-number":"4.1","data-text":"Multi-Sensor Angle Synchronization","data-toc-number":"4.1",children:"4.1 Multi-Sensor Angle Synchronization"}),"\n",(0,s.jsx)(n.p,{children:"In autonomous driving solutions, it is often necessary for multiple lidar sensors on the same vehicle to simultaneously point to the front of the vehicle to ensure they can capture the same environmental information. However, since these lidars are usually installed in different positions, the hardware connector direction (i.e., the 0\xb0 direction of the lidar itself) also differs. By enabling sync angle and setting the corresponding angle values, all lidars can point tp the same direction at the same time after time synchronization, which could improve the data accuracy and consistency."}),"\n",(0,s.jsx)("img",{src:(0,o.Ay)("/img/multi_lidars_sync.png"),alt:"multi_lidars_sync",style:{display:"block",margin:"0 auto",width:"auto"}}),"\n",(0,s.jsx)(n.p,{children:"As shown in the diagram:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"lidar #1's 180\xb0 direction points to the front of the vehicle;"}),"\n",(0,s.jsx)(n.li,{children:"lidar #2's 270\xb0 direction points to the front of the vehicle;"}),"\n",(0,s.jsx)(n.li,{children:"lidar #3's 90\xb0 direction points to the front of the vehicle;"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Thus, the sync angle configuration for these three lidars should be set to 180\xb0, 270\xb0, and 90\xb0, respectively."}),"\n",(0,s.jsx)(n.h3,{id:"anti-interference-between-lidars",className:"numbered-heading","data-number":"4.2","data-text":"Anti-Interference between lidars","data-toc-number":"4.2",children:"4.2 Anti-Interference between lidars"}),"\n",(0,s.jsx)(n.p,{children:"See the scenario illustrated in the diagram below, when two lidars are installed very close to each other on the same vehicle, there will be a high probability of severe mutual interference, resulting in a large number of noise points and data quality degradation."}),"\n",(0,s.jsx)("img",{src:(0,o.Ay)("/img/interference.png"),alt:"interference",style:{display:"block",margin:"0 auto",width:"auto"}}),"\n",(0,s.jsx)(n.p,{children:"For such scenarios, the best solution is to place physical barriers between the two lidars to eliminate mutual interference. However, when this solution is not feasible in practice, the sync angle feature can still be used to resolve this issue: Considering that interference usually occurs when the laser emitted by one lidar is received by the other lidar, through proper sync angle settings the two lidars can only point to each other within a limited azimuth range (i.e. mutual shooting zone), and by setting the effective FOV range of both lidars to finally avoid them emitting lasers in the mutual shooting zone. The specific operation process is as follows:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Synchronize the two lidars to the same clock source;"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Configure sync angle values. Based on the scenario in the diagram above, when the connector directions of these two lidars are consistent and both point to the rear of the vehicle, the synchronization angle for lidar #1 (left side) can be set to 270\xb0, and the synchronization angle for lidar #2 (right side) can be set to 90\xb0, achieving mutual shooting at a specific moment;"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Set the effective horizontal FOV range. The affected azimuth range \ud835\udf03\ud835\udc60 during mutual shooting can be calculated using the following formula\uff1a"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)("img",{src:(0,o.Ay)("/img/sync_fov.PNG"),alt:"sync_fov",style:{display:"block",margin:"0 auto",width:"auto"}}),"\n",(0,s.jsx)(n.p,{children:"In the formula, \ud835\udc37 is the lidar diameter, and \ud835\udc59 is the distance between the two lidars. Using the XT32 model and the scenario shown in the diagram below, when the centers of the two lidars are 1m apart, the calculated invalid angle range \ud835\udf03\ud835\udc60 is approximately 6\xb0:"}),"\n",(0,s.jsx)("img",{src:(0,o.Ay)("/img/sync_angle_interference.png"),alt:"sync_angle_interference",style:{display:"block",margin:"0 auto",width:"auto"}}),"\n",(0,s.jsx)(n.p,{children:"From the results in this diagram, the effective FOV range for these two lidars can be set to the azimuth range outside the corresponding sync angle value \xb1 5\xb0 (with some FOV setting margin reserved), ensuring that both lidars only emit lasers within the following FOV ranges:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"lidar #1: 275\xb0~265\xb0"}),"\n",(0,s.jsx)(n.li,{children:"lidar #2: 95\xb0~85\xb0"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Note: The rotation direction of both lidars is the default clockwise rotation."})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);