"use strict";(globalThis.webpackChunkdocusaurus_wiki=globalThis.webpackChunkdocusaurus_wiki||[]).push([[4415],{1688(e,a,t){t.r(a),t.d(a,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"how_to_guides/Get_IMU_data","title":"Acquire and Parse IMU Data","description":"Overview","source":"@site/docs/how_to_guides/Get_IMU_data.md","sourceDirName":"how_to_guides","slug":"/how_to_guides/Get_IMU_data","permalink":"/dev/docs/how_to_guides/Get_IMU_data","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10},"sidebar":"howToSidebar","previous":{"title":"Acquire Angle Correction File","permalink":"/dev/docs/how_to_guides/Angle-Correction-File"},"next":{"title":"Use PandarView","permalink":"/dev/docs/how_to_guides/PandarView"}}');var n=t(4848),s=t(8453),r=t(9030);const l={sidebar_position:10},o="Acquire and Parse IMU Data",d={},c=[{value:"Overview",id:"overview",level:2},{value:"Acquire IMU Data",id:"acquire-imu-data",level:2},{value:"Connect Lidar to Obtain Data Packets",id:"connect-lidar-to-obtain-data-packets",level:3},{value:"IMU Data Format",id:"imu-data-format",level:3},{value:"Example",id:"example",level:3},{value:"Parse IMU Data",id:"parse-imu-data",level:2},{value:"Parse IMU Data Online with ROS",id:"parse-imu-data-online-with-ros",level:3},{value:"Parse IMU Data Offline with ROS",id:"parse-imu-data-offline-with-ros",level:3},{value:"View IMU Data in Real-Time or Offline with RVIZ/PlotJuggler",id:"view-imu-data-in-real-time-or-offline-with-rvizplotjuggler",level:3}];function h(e){const a={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.header,{children:(0,n.jsx)(a.h1,{id:"acquire-and-parse-imu-data",children:"Acquire and Parse IMU Data"})}),"\n",(0,n.jsx)(a.h2,{id:"overview",className:"numbered-heading","data-number":"1","data-text":"Overview","data-toc-number":"1",children:"1 Overview"}),"\n",(0,n.jsx)(a.p,{children:"Hesai's JT and Pandar series lidars are integrated with built-in IMU device. Users can refer to this document to acquire and parse IMU data."}),"\n",(0,n.jsx)(a.p,{children:"This document provides a detailed introduction to acquiring and analyzing the built-in IMU data of lidar, as well as methods for viewing IMU data in real-time or offline using tools such as ROS RVIZ and PlotJuggler."}),"\n",(0,n.jsx)(a.h2,{id:"acquire-imu-data",className:"numbered-heading","data-number":"2","data-text":"Acquire IMU Data","data-toc-number":"2",children:"2 Acquire IMU Data"}),"\n",(0,n.jsx)(a.h3,{id:"connect-lidar-to-obtain-data-packets",className:"numbered-heading","data-number":"2.1","data-text":"Connect Lidar to Obtain Data Packets","data-toc-number":"2.1",children:"2.1 Connect Lidar to Obtain Data Packets"}),"\n",(0,n.jsxs)(a.p,{children:["IMU data from the lidar can be obtained through lidar's Ethernet connection or serial port connection (see ",(0,n.jsx)(a.a,{href:"/dev/docs/how_to_guides/network_config",children:"How to Configure Ethernet"})," or ",(0,n.jsx)(a.a,{href:"/dev/docs/how_to_guides/serial_port_config",children:"How to Configure Serial Port"})," for detailed connection methods). The general data acquisition method and steps are as follows:"]}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Connecting the Lidar:"})," Power on the lidar and connect it to the computer via an Ethernet cable or a USB-to-serial adapter."]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Obtaining Lidar Data Packets:"})," Use software such as Wireshark to capture UDP port data packets or use serial monitoring software to capture serial port data."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(a.h3,{id:"imu-data-format",className:"numbered-heading","data-number":"2.2","data-text":"IMU Data Format","data-toc-number":"2.2",children:"2.2 IMU Data Format"}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.strong,{children:"2.2.1 Ethernet Data Packet Format"})}),"\n",(0,n.jsx)(a.p,{children:"IMU data is included at the end of the UDP data packet. For example, in JT128, the data starts from the 31st byte and spans 22 bytes (including 4 reserved bytes). The specific data structure is shown in the figure below:"}),"\n",(0,n.jsx)("img",{src:(0,r.Ay)("/img/IMU_udpPacket_EN.jpg"),alt:"IMU_udpPacket_EN",style:{display:"block",margin:"0 auto",width:"auto"}}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.em,{children:"Note: For other lidar models, refer to the respective user manuals for the IMU data structure."})}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.strong,{children:"2.2.2 Serial Data Format (JT16)"})}),"\n",(0,n.jsx)(a.p,{children:"The IMU data packet format consists of 34 bytes, including a 6-byte header, a 10-byte data header, a 14-byte data body, and a 4-byte data tail. The header structure is shown below (IMU data packet, Data Type: 0x01):"}),"\n",(0,n.jsx)("img",{src:(0,r.Ay)("/img/JT16_PreHeader_EN.jpg"),alt:"JT16_PreHeader_EN",style:{display:"block",margin:"0 auto",width:"auto"}}),"\n",(0,n.jsx)(a.p,{children:"The data header structure is as follows (mainly for timestamps):"}),"\n",(0,n.jsx)("img",{src:(0,r.Ay)("/img/JT16_Header_EN.jpg"),alt:"JT16_Header_EN",style:{display:"block",margin:"0 auto",width:"auto"}}),"\n",(0,n.jsx)(a.p,{children:"The data body structure is as follows (three-axis acceleration and three-axis angular velocity):"}),"\n",(0,n.jsx)("img",{src:(0,r.Ay)("/img/JT16_IMU_BodyPacket_EN.jpg"),alt:"JT16_IMU_BodyPacket_EN",style:{display:"block",margin:"0 auto",width:"auto"}}),"\n",(0,n.jsx)(a.p,{children:"The data tail contains the CRC checksum field."}),"\n",(0,n.jsx)(a.h3,{id:"example",className:"numbered-heading","data-number":"2.3","data-text":"Example","data-toc-number":"2.3",children:"2.3 Example"}),"\n",(0,n.jsx)(a.p,{children:"For JT128, the specific structure of the IMU data in a PCAP file is shown below:"}),"\n",(0,n.jsx)("img",{src:(0,r.Ay)("/img/JT128_IMU_BodyPacket_example.jpg"),alt:"JT128_IMU_BodyPacket_example",style:{display:"block",margin:"0 auto",width:"auto"}}),"\n",(0,n.jsx)(a.h2,{id:"parse-imu-data",className:"numbered-heading","data-number":"3","data-text":"Parse IMU Data","data-toc-number":"3",children:"3 Parse IMU Data"}),"\n",(0,n.jsx)(a.h3,{id:"parse-imu-data-online-with-ros",className:"numbered-heading","data-number":"3.1","data-text":"Parse IMU Data Online with ROS","data-toc-number":"3.1",children:"3.1 Parse IMU Data Online with ROS"}),"\n",(0,n.jsxs)(a.p,{children:["Hesai's official ",(0,n.jsx)(a.a,{href:"https://github.com/HesaiTechnology/HesaiLidar_ROS_2.0",children:"ROS/SDK"})," supports IMU data parsing. Users can connect the lidar and run the launch/py file to publish the lidar IMU data topic. The specific steps are as follows:"]}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.strong,{children:"ROS1"})}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsx)(a.li,{children:"Run the launch file:"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"roslaunch hesai_ros_driver start.launch\n"})}),"\n",(0,n.jsxs)(a.ol,{start:"2",children:["\n",(0,n.jsx)(a.li,{children:"Use the following command to view the IMU data topic, as shown below:"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"rostopic list\n"})}),"\n",(0,n.jsx)("img",{src:(0,r.Ay)("/img/IMU_rostopic_name.jpg"),alt:"IMU_rostopic_name",style:{display:"block",margin:"0 auto",width:"auto"}}),"\n",(0,n.jsxs)(a.ol,{start:"3",children:["\n",(0,n.jsx)(a.li,{children:"Use the following command to view real-time IMU data. The returned result is shown below:"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"rostopic echo /lidar/imu\n"})}),"\n",(0,n.jsx)("img",{src:(0,r.Ay)("/img/IMU_rostopic_msg.jpg"),alt:"IMU_rostopic_msg",style:{display:"block",margin:"0 auto",width:"auto"}}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.strong,{children:"ROS2"})}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsx)(a.li,{children:"Run the py file:"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"ros2 launch hesai_ros_driver start.py\n"})}),"\n",(0,n.jsxs)(a.ol,{start:"2",children:["\n",(0,n.jsx)(a.li,{children:"Use the following command to view the IMU data topic. The result is the same as in ROS1:"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"ros2 topic list\n"})}),"\n",(0,n.jsxs)(a.ol,{start:"3",children:["\n",(0,n.jsx)(a.li,{children:"Use the following command to view real-time IMU data. The result is the same as in ROS1:"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"ros2 topic echo /lidar/imu\n"})}),"\n",(0,n.jsx)(a.h3,{id:"parse-imu-data-offline-with-ros",className:"numbered-heading","data-number":"3.2","data-text":"Parse IMU Data Offline with ROS","data-toc-number":"3.2",children:"3.2 Parse IMU Data Offline with ROS"}),"\n",(0,n.jsx)(a.p,{children:"Raw IMU data saved in PCAP files can be parsed using the SDK and directly replayed to view IMU data saved in ROS bags."}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["Example: replay the ROS bag of JT128 in ",(0,n.jsx)(a.strong,{children:"ROS1"})," to view IMU data, as shown below:"]}),"\n"]}),"\n",(0,n.jsx)("img",{src:(0,r.Ay)("/img/IMU_offline.jpg"),alt:"IMU_offline",style:{display:"block",margin:"0 auto",width:"80%"}}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["Example: replay the ROS bag of JT128 in ",(0,n.jsx)(a.strong,{children:"ROS2"})," to view IMU data, as shown below:"]}),"\n"]}),"\n",(0,n.jsx)("img",{src:(0,r.Ay)("/img/IMU_offline_ROS2.jpg"),alt:"IMU_offline_ROS2",style:{display:"block",margin:"0 auto",width:"80%"}}),"\n",(0,n.jsx)(a.h3,{id:"view-imu-data-in-real-time-or-offline-with-rvizplotjuggler",className:"numbered-heading","data-number":"3.3","data-text":"View IMU Data in Real-Time or Offline with RVIZ/PlotJuggler","data-toc-number":"3.3",children:"3.3 View IMU Data in Real-Time or Offline with RVIZ/PlotJuggler"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"ROS provides a 3D visualization tool, RVIZ, which allows users to load IMU display elements and view the IMU's orientation in real-time or during offline playback."}),"\n",(0,n.jsx)(a.li,{children:"PlotJuggler is a Qt-based data visualization tool that is particularly advantageous for displaying time-series data such as velocity and pose. It allows users to view the changes in three-axis acceleration and three-axis angular velocity over time in real-time or during offline playback."}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.strong,{children:"3.3.1 RVIZ Display"})}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:["Click ",(0,n.jsx)(a.strong,{children:"Add"})," button and add the IMU display element by topic, as shown below:"]}),"\n"]}),"\n",(0,n.jsx)("img",{src:(0,r.Ay)("/img/IMU_rviz_config.jpg"),alt:"IMU_rviz_config",style:{display:"block",margin:"0 auto",width:"80%"}}),"\n",(0,n.jsxs)(a.ol,{start:"2",children:["\n",(0,n.jsxs)(a.li,{children:["Set ",(0,n.jsx)(a.strong,{children:"Fixed Frame"})," to ",(0,n.jsx)(a.code,{children:"hesai_lidar"}),". The final display is shown below:"]}),"\n"]}),"\n",(0,n.jsx)("img",{src:(0,r.Ay)("/img/IMU_rviz.jpg"),alt:"IMU_rviz",style:{display:"block",margin:"0 auto",width:"80%"}}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.strong,{children:"3.3.2 PlotJuggler Display"})}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsx)(a.li,{children:"Load the recorded data file, select the IMU-related topic, or listen to the IMU-related topic from the real-time stream."}),"\n",(0,n.jsx)(a.li,{children:"Drag the IMU data to the chart display area on the right to clearly display the changes in IMU data over time."}),"\n",(0,n.jsx)(a.li,{children:"The display result is shown below:"}),"\n"]}),"\n",(0,n.jsx)("img",{src:(0,r.Ay)("/img/IMU_plotjuggler_display.jpg"),alt:"IMU_plotjuggler_display",style:{display:"block",margin:"0 auto",width:"80%"}})]})}function u(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},8453(e,a,t){t.d(a,{R:()=>r,x:()=>l});var i=t(6540);const n={},s=i.createContext(n);function r(e){const a=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function l(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),i.createElement(s.Provider,{value:a},e.children)}}}]);