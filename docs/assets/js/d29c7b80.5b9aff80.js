"use strict";(globalThis.webpackChunkdocusaurus_wiki=globalThis.webpackChunkdocusaurus_wiki||[]).push([[3610],{1676(e,n,r){r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"how_to_guides/HTTP_api","title":"Use HTTP API","description":"Overview","source":"@site/docs/how_to_guides/HTTP_api.md","sourceDirName":"how_to_guides","slug":"/how_to_guides/HTTP_api","permalink":"/dev/docs/how_to_guides/HTTP_api","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"howToSidebar","previous":{"title":"Configure Serial Port","permalink":"/dev/docs/how_to_guides/serial_port_config"},"next":{"title":"Use TCP API","permalink":"/dev/docs/how_to_guides/TCP_api"}}');var a=r(4848),s=r(8453),i=r(9030);const o={sidebar_position:3},d="Use HTTP API",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Application Method",id:"application-method",level:2},{value:"Examples",id:"examples",level:2},{value:"Retrieve Lidar Parameters (GET)",id:"retrieve-lidar-parameters-get",level:3},{value:"Configure Lidar Parameters (SET)",id:"configure-lidar-parameters-set",level:3}];function h(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"use-http-api",children:"Use HTTP API"})}),"\n",(0,a.jsx)(n.h2,{id:"overview",className:"numbered-heading","data-number":"1","data-text":"Overview","data-toc-number":"1",children:"1 Overview"}),"\n",(0,a.jsx)(n.p,{children:"Hesai HTTP API provides a standard HTTP interface that allows developers to interact with lidar devices using simple HTTP commands. With this API, you can easily perform operations such as retrieving lidar parameters and configuring features."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Note: HTTP API is only applicable to Hesai lidar models that support HTTP servers, including the Pandar series, QT series and XT series."})}),"\n",(0,a.jsx)(n.h2,{id:"application-method",className:"numbered-heading","data-number":"2","data-text":"Application Method","data-toc-number":"2",children:"2 Application Method"}),"\n",(0,a.jsx)(n.p,{children:"The application method of HTTP API commands is introduced as follows:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Connect the lidar to the host computer and ensure proper communication is established (refer to ",(0,a.jsx)(n.a,{href:"/dev/docs/how_to_guides/network_config#application-method",children:"Configure Ethernet"})," for details);"]}),"\n",(0,a.jsx)(n.li,{children:"Send HTTP API commands from the host computer to the lidar. It is recommended to use Python scripts for this purpose. A sample code is provided below:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\n# -*- coding: utf-8 -*-\n\nfrom urllib import request, parse\nimport requests\nimport json\nimport sys\nimport getopt\nimport IPy\nimport time\nimport os\n\n## Lidar IP address\n\nipaddr = \"192.168.1.201\"\n\n## HTTP API command\n\nlocal_url = 'http://' + ipaddr + '/pandar.cgi?action=get&object=lidar_config'\nf = None  # Initialize f\ntry:\n    f = request.urlopen(local_url, timeout=3.0)\n    print(\"Success!\")\n    data = f.read()\n    print(data)\n    print('Status:', f.status, f.reason)\n    json_data = data.decode('utf-8')\n    py_dict = json.loads(json_data)\n    py_body = py_dict.get('Body')\n\nexcept Exception as e:\n    print(f\"Error connecting to {local_url}: {e}\")\nfinally:\n    if f:\n        f.close()\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"In the above sample code, there are two parameters that require special attention:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.em,{children:"ipaddr"}),": The IP address of the lidar"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.em,{children:"local_url"}),": The string corresponding to the HTTP API command"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"During actual operation, these two parameters need to be updated based on the lidar's IP configuration and the purpose of the HTTP API."}),"\n",(0,a.jsxs)(n.ol,{start:"3",children:["\n",(0,a.jsx)(n.li,{children:"Retrieve the response from the lidar to confirm whether the API command was successfully sent."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"examples",className:"numbered-heading","data-number":"3","data-text":"Examples","data-toc-number":"3",children:"3 Examples"}),"\n",(0,a.jsx)(n.p,{children:"This document provides some common use cases as examples to illustrate the usage of the HTTP API."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.em,{children:"Note: The following examples are based on the model of XT32M2X. The HTTP API commands for different lidar models may vary. Please refer to the HTTP API manual of the specific model."})}),"\n",(0,a.jsx)(n.h3,{id:"retrieve-lidar-parameters-get",className:"numbered-heading","data-number":"3.1","data-text":"Retrieve Lidar Parameters (GET)","data-toc-number":"3.1",children:"3.1 Retrieve Lidar Parameters (GET)"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Set the ",(0,a.jsx)(n.em,{children:"ipaddr"})," parameter in the sample code according to the current IP address of the lidar;"]}),"\n",(0,a.jsxs)(n.li,{children:["Modify the ",(0,a.jsx)(n.em,{children:"local_url"})," in the sample code as follows (this example retrieves basic information about the lidar), and run the Python script on the host computer:"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"\n## HTTP API command\n\nlocal_url = 'http://' + ipaddr + '/pandar.cgi?action=get&object=device_info'\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"3",children:["\n",(0,a.jsx)(n.li,{children:"The output will include basic information about the lidar, e.g. SN, MAC address, firmware version, etc. Here is the output example:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'Success!\nb\'{"Head":{"ErrorCode":"0","Message": "Success"},"Body":{"SN": "XT3ACD5F983ACC56","Mac": "EC:9F:00:01:58:3D", "SW Ver: "2.1.7","HW Ver":"1.0.0","FW Ver":"2.0.11","Model":"XT32M2X","Angleoffset":"9129", "Calibsize":"0","FPGA_Ver":"","LidarCalibsize":"384","Up_Fpga_Ver":" 2.1.4","Udp_Seq":"1","1","ProdDate":"2023-06-08", "ProdName":"XT32M2X-B01","LidarDataformat":"1","Trigger_Method":"0","LaserNum":"32","Firing_Method":"",""AccAnglePhase":"0","AccAn\nglePeak": "0","AccAngleEnable":"0","0","MotorType":"0", "LargeCodeRange":"1","Codewheel_cal":"1","MotorStartAngle_en":"0", "MotorstartAngle_val":"0","UpFpgaconfigsha":"f80c28c5", "UpFpgacorrectsha":"ef480d97","PN":""XT32M2X"}}\'\nStatus:200 OK\n'})}),"\n",(0,a.jsx)(n.h3,{id:"configure-lidar-parameters-set",className:"numbered-heading","data-number":"3.2","data-text":"Configure Lidar Parameters (SET)","data-toc-number":"3.2",children:"3.2 Configure Lidar Parameters (SET)"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Set the ",(0,a.jsx)(n.em,{children:"ipaddr"})," parameter in the sample code according to the current IP address of the lidar;"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Modify the ",(0,a.jsx)(n.em,{children:"local_url"})," in the sample code as follows (this example configures the lidar to ",(0,a.jsx)(n.strong,{children:"dual return"})," mode), and run the Python script on the host computer:"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"\n## HTTP API command\n\nlocal_url = 'http://' + ipaddr + '/pandar.cgi?action=set&object=lidar_data&key=lidar_mode&value=2'\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"3",children:["\n",(0,a.jsx)(n.li,{children:"If the following output is displayed in the terminal, the configuration was successful:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'Success!\nb\'{"Head":{"ErrorCode":"0","Message": "Success"}}\'\nStatus:200 OK\n'})}),"\n",(0,a.jsxs)(n.ol,{start:"4",children:["\n",(0,a.jsx)(n.li,{children:"Open a web browser, enter the lidar's IP address and confirm that the return mode configuration is already effective on the lidar's control page:"}),"\n"]}),"\n",(0,a.jsx)("img",{src:(0,i.Ay)("/img/http_dualreturn.png"),alt:"http_dualreturn",style:{display:"block",margin:"0 auto",width:"auto"}})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},8453(e,n,r){r.d(n,{R:()=>i,x:()=>o});var t=r(6540);const a={},s=t.createContext(a);function i(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);